<div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-11-23T11:54:03.404Z" title="2020-11-23T11:54:03.404Z">2020-11-23</time><span class="level-item">6 分钟 读完 (大约 945 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">ms17_010（永恒之蓝）漏洞利用</h1><div class="content"><h1 id="ms17-010（永恒之蓝）漏洞利用"><a href="#ms17-010（永恒之蓝）漏洞利用" class="headerlink" title="ms17_010（永恒之蓝）漏洞利用"></a>ms17_010（永恒之蓝）漏洞利用</h1><h2 id="1、MS17-010是什么"><a href="#1、MS17-010是什么" class="headerlink" title="1、MS17-010是什么"></a>1、MS17-010是什么</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MS17-010漏洞利用模块就是利用Windows系统的Windows SMB远程执行代码漏洞，</span><br><span class="line">向Microsoft服务器消息块（SMBv1）服务器发送经特殊设计的消息后，允许远程代码执行。</span><br><span class="line">成功利用这些漏洞的攻击者即可获得在目标系统上执行代码的权利。</span><br></pre></td></tr></table></figure>
<p>&lt;!– more –&gt;</p>
<h2 id="2、准备虚拟机win7-64位和kali"><a href="#2、准备虚拟机win7-64位和kali" class="headerlink" title="2、准备虚拟机win7 64位和kali"></a>2、准备虚拟机win7 64位和kali</h2><p>查看win7虚拟机IP：</p>
<p><img src="https://img-blog.csdnimg.cn/20201119104430862.png#pic_center" alt="在这里插入图片描述"><br>kali IP：<br><img src="https://img-blog.csdnimg.cn/20201119104508485.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="3、对win7进行端口扫描"><a href="#3、对win7进行端口扫描" class="headerlink" title="3、对win7进行端口扫描"></a>3、对win7进行端口扫描</h2><p>使用kali的nmap工具进行扫描，在kali终端输入nmap –sS –sV –Pn 192.168.0.101即可进行扫描，-sS 是半开放扫描，比普通扫描要快,-sV是版本检测,-Pn是不对目标主机进行存活性判断，直接扫描，注意要把win7的防火墙关闭了，不然会被拦截</p>
<p><img src="https://img-blog.csdnimg.cn/20201119105235223.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>445端口开放。</p>
<h2 id="4、使用Metasploit-Framework工具"><a href="#4、使用Metasploit-Framework工具" class="headerlink" title="4、使用Metasploit Framework工具"></a>4、使用Metasploit Framework工具</h2><p>（1）搜索ms17_010漏洞利用模块<br><img src="https://img-blog.csdnimg.cn/20201119105743985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>（2）先使用Auxiliaries辅助模块：auxiliary/scanner/smb/smb_ms17_010这个模块进行漏洞的分析，看看445端口是否能被入侵<br><img src="https://img-blog.csdnimg.cn/20201119110249320.png#pic_center" alt="在这里插入图片描述"><br>show options查看这个模块的选项，在Required那列中，yes的是必填的,no是选填的，默认帮我们已经写好了大部分的参数，但我们还是要手动设置一下RHOSTS的参数，即指定的主机ip，这里我们写被攻击的win7的ip<br><img src="https://img-blog.csdnimg.cn/20201119110331965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>set RHOSTS 192.168.175.129<br><img src="https://img-blog.csdnimg.cn/20201119110427679.png#pic_center" alt="在这里插入图片描述"><br>接着输入run执行探测<br><img src="https://img-blog.csdnimg.cn/20201119110751987.png#pic_center" alt="在这里插入图片描述"><br>主机可能容易受到MS17-010的攻击！<br>这里就基本可以确认，ms17-010可以入侵该win7<br>（3）使用攻击模块<br><img src="https://img-blog.csdnimg.cn/20201119111008510.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>使用这个模块，我们show targets看一下这个模块适用于哪些系统的主机<br><img src="https://img-blog.csdnimg.cn/20201119111033819.png#pic_center" alt="在这里插入图片描述"><br>可以看到,win7和server 2008 r2都适用<br>show options来看看有哪些选项</p>
<p><img src="https://img-blog.csdnimg.cn/20201119111103683.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>设置RHOST，即要攻击的主机ip即可<br>set RHOST 192.168.175.129<br><img src="https://img-blog.csdnimg.cn/20201119111142361.png#pic_center" alt="在这里插入图片描述"><br>接着run执行攻击<br><img src="https://img-blog.csdnimg.cn/20201119111216627.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>出现了win7的cmd，这是已经是渗透成功了。但有时候不一定会成功，会返回FAIL，说明这个系统打了补丁，这个漏洞已经没有威力了。<br>之后就可以建用户开端口了，渗透成功。</p>
</div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/11/23/Metasploit%E5%AD%A6%E4%B9%A0%EF%BC%9A%20Samba%E6%9C%8D%E5%8A%A1%20usermap_script%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"><span class="level-item">Metasploit学习： Samba服务 usermap_script安全漏洞利用</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2020/11/23/ms17_010%EF%BC%88%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/';
            this.page.identifier = '2020/11/23/ms17_010（永恒之蓝）漏洞利用/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + '1' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div>