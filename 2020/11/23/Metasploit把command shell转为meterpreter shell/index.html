<div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-11-23T11:54:03.399Z" title="2020-11-23T11:54:03.399Z">2020-11-23</time><span class="level-item">2 分钟 读完 (大约 340 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">Metasploit把command shell转为meterpreter shell</h1><div class="content"><h1 id="Metasploit把command-shell转为meterpreter-shell-lt-–-more-–-gt"><a href="#Metasploit把command-shell转为meterpreter-shell-lt-–-more-–-gt" class="headerlink" title="Metasploit把command shell转为meterpreter shell&lt;!– more –&gt;"></a>Metasploit把command shell转为meterpreter shell&lt;!– more –&gt;</h1><h2 id="获取command-shell"><a href="#获取command-shell" class="headerlink" title="获取command shell"></a>获取command shell</h2><p>使用metasploit工具，使用漏洞利用模块exploit/multi/samba/usermap_script拿到metasploitbale虚拟机的shell。<a href="https://blog.csdn.net/Karol_agan/article/details/109784575">(详细请点击)</a></p>
<p><img src="https://img-blog.csdnimg.cn/20201118200358301.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>这里的shell是普通的command shell</p>
<h2 id="shell转换"><a href="#shell转换" class="headerlink" title="shell转换"></a>shell转换</h2><p>ctrl+Z，选择y，则将当前shell放到后台。</p>
<p><img src="https://img-blog.csdnimg.cn/20201118200416972.png#pic_center" alt="在这里插入图片描述"></p>
<p>输入sessions -l(小写的L)查看当前活跃的sessions</p>
<p><img src="https://img-blog.csdnimg.cn/20201118200430355.png#pic_center" alt="在这里插入图片描述"></p>
<p>是刚才挂起的metasploitable的shell，当前的session id是2，执行下图命令<br>use post/multi/manage/shell_to_meterpreter<br><img src="https://img-blog.csdnimg.cn/20201119112720324.png#pic_center" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20201118200444320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0thcm9sX2FnYW4=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>再次输入sessions -l 查看后台的sessions</p>
<p><img src="https://img-blog.csdnimg.cn/20201118200457808.png#pic_center" alt="在这里插入图片描述"></p>
<p>多了一个Id为3的meterpreter shell，输入session -i 3,调用Id为3的shell,至此转换成功。</p>
<p><img src="https://img-blog.csdnimg.cn/20201118200512938.png#pic_center" alt="在这里插入图片描述"></p>
</div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/11/23/Metasploit%E5%AD%A6%E4%B9%A0%EF%BC%9A%20Samba%E6%9C%8D%E5%8A%A1%20usermap_script%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Metasploit学习： Samba服务 usermap_script安全漏洞利用</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/06/12/hello-world/"><span class="level-item">Hello World</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2020/11/23/Metasploit%E6%8A%8Acommand%20shell%E8%BD%AC%E4%B8%BAmeterpreter%20shell/';
            this.page.identifier = '2020/11/23/Metasploit把command shell转为meterpreter shell/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + '1' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div>